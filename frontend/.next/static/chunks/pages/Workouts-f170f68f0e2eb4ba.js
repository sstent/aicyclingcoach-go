(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[192],{263:function(e,t,n){"use strict";n.d(t,{a:function(){return i}}),n(4687);var a=n(7294);n(5678),n(3454);var r=(0,a.createContext)(),i=function(){var e=(0,a.useContext)(r);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},8237:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var a=n(29),r=n(4687),i=n.n(r),s=n(7294),o=n(263),d=n(7066),l=n(2364),c=function(e){var t,n,a,r,i=e.workout;return(0,l.BX)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[(0,l.BX)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,l.tZ)("p",{className:"text-sm text-gray-600",children:"Duration"}),(0,l.tZ)("p",{className:"text-lg font-medium",children:(t=i.duration_seconds,"".concat(Math.floor(t/60)," minutes"))})]}),(0,l.BX)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,l.tZ)("p",{className:"text-sm text-gray-600",children:"Distance"}),(0,l.BX)("p",{className:"text-lg font-medium",children:[(i.distance_m/1e3).toFixed(1)," km"]})]}),(0,l.BX)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,l.tZ)("p",{className:"text-sm text-gray-600",children:"Avg Power"}),(0,l.BX)("p",{className:"text-lg font-medium",children:[(null===(n=i.avg_power)||void 0===n?void 0:n.toFixed(0))||"-"," W"]})]}),(0,l.BX)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,l.tZ)("p",{className:"text-sm text-gray-600",children:"Avg HR"}),(0,l.BX)("p",{className:"text-lg font-medium",children:[(null===(a=i.avg_hr)||void 0===a?void 0:a.toFixed(0))||"-"," bpm"]})]}),(0,l.BX)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,l.tZ)("p",{className:"text-sm text-gray-600",children:"Elevation"}),(0,l.BX)("p",{className:"text-lg font-medium",children:[(null===(r=i.elevation_gain_m)||void 0===r?void 0:r.toFixed(0))||"-"," m"]})]})]})},u=function(e){var t,n,r=e.workoutId,u=(0,o.a)().apiKey,m=(0,s.useState)(null),p=m[0],f=m[1],h=(0,s.useState)(!1),g=h[0],v=h[1];(0,s.useEffect)(function(){var e,t=(e=(0,a.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.Z.get("/api/analyses/".concat(r),{headers:{"X-API-Key":u}});case 3:f(e.sent.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching analysis:",e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])})),function(){return e.apply(this,arguments)});r&&t()},[r,u]);var y=(t=(0,a.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),e.prev=1,e.next=4,d.Z.post("/api/analyses/".concat(p.id,"/approve"),{},{headers:{"X-API-Key":u}});case 4:return e.next=6,d.Z.get("/api/analyses/".concat(p.id),{headers:{"X-API-Key":u}});case 6:f(e.sent.data),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("Approval failed:",e.t0);case 13:v(!1);case 14:case"end":return e.stop()}},e,null,[[1,10]])})),function(){return t.apply(this,arguments)});return p?(0,l.BX)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,l.BX)("h3",{className:"text-xl font-semibold mb-4",children:[p.workout.activity_type," Analysis"]}),(0,l.tZ)(c,{workout:p.workout}),(0,l.BX)("div",{className:"mt-6",children:[(0,l.tZ)("h4",{className:"font-medium mb-2",children:"AI Feedback"}),(0,l.BX)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,l.tZ)("p",{className:"mb-3",children:p.jsonb_feedback.summary}),(0,l.BX)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.BX)("div",{children:[(0,l.tZ)("h5",{className:"font-medium",children:"Strengths"}),(0,l.tZ)("ul",{className:"list-disc pl-5",children:p.jsonb_feedback.strengths.map(function(e,t){return(0,l.tZ)("li",{className:"text-green-700",children:e},t)})})]}),(0,l.BX)("div",{children:[(0,l.tZ)("h5",{className:"font-medium",children:"Improvements"}),(0,l.tZ)("ul",{className:"list-disc pl-5",children:p.jsonb_feedback.areas_for_improvement.map(function(e,t){return(0,l.tZ)("li",{className:"text-orange-700",children:e},t)})})]})]})]})]}),(null===(n=p.suggestions)||void 0===n?void 0:n.length)>0&&!p.approved&&(0,l.tZ)("div",{className:"mt-6",children:(0,l.tZ)("button",{onClick:y,disabled:g,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:bg-gray-400",children:g?"Approving...":"Approve Suggestions"})}),(0,l.tZ)(WorkoutCharts,{metrics:p.workout.metrics})]}):(0,l.tZ)("div",{children:"Loading analysis..."})},m=function(){var e=(0,o.a)().apiKey,t=(0,s.useState)([]),n=t[0],r=t[1],c=(0,s.useState)(null),m=c[0],p=c[1],f=(0,s.useState)(!0),h=f[0],g=f[1],v=(0,s.useState)(""),y=v[0],x=v[1];return(0,s.useEffect)(function(){var t;(t=(0,a.Z)(i().mark(function t(){return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d.Z.get("/api/workouts",{headers:{"X-API-Key":e}});case 3:r(t.sent.data.workouts),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),x("Failed to load workouts");case 10:return t.prev=10,g(!1),t.finish(10);case 13:case"end":return t.stop()}},t,null,[[0,7,10,13]])})),function(){return t.apply(this,arguments)})()},[e]),h?(0,l.tZ)("div",{className:"p-6 text-center",children:"Loading workouts..."}):y?(0,l.tZ)("div",{className:"p-6 text-red-600",children:y}):(0,l.BX)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,l.tZ)("h1",{className:"text-3xl font-bold mb-8",children:"Workouts"}),(0,l.BX)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.tZ)("div",{className:"space-y-4",children:n.map(function(e){return(0,l.BX)("div",{onClick:function(){return p(e)},className:"p-4 bg-white rounded-lg shadow-md cursor-pointer ".concat((null==m?void 0:m.id)===e.id?"ring-2 ring-blue-500":""),children:[(0,l.BX)("h3",{className:"font-medium",children:[new Date(e.start_time).toLocaleDateString()," - ",e.activity_type]}),(0,l.BX)("p",{className:"text-sm text-gray-600",children:["Duration: ",Math.round(e.duration_seconds/60),"min"]})]},e.id)})}),m&&(0,l.tZ)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:(0,l.tZ)(u,{workoutId:m.id})})]})]})}},8263:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Workouts",function(){return n(8237)}])},5678:function(e,t,n){"use strict";var a=n(7294);let r=e=>"number"==typeof e&&!isNaN(e),i=e=>"string"==typeof e,s=e=>"function"==typeof e,o=e=>(0,a.isValidElement)(e)||i(e)||s(e)||r(e);function d(e){let{enter:t,exit:n,appendPosition:r=!1,collapse:i=!0,collapseDuration:s=300}=e;return function(e){let{children:o,position:d,preventExitTransition:l,done:c,nodeRef:u,isIn:m,playToast:p}=e,f=r?`${t}--${d}`:t,h=r?`${n}--${d}`:n,g=(0,a.useRef)(0);return(0,a.useLayoutEffect)(()=>{let e=u.current,t=f.split(" "),n=a=>{a.target===u.current&&(p(),e.removeEventListener("animationend",n),e.removeEventListener("animationcancel",n),0===g.current&&"animationcancel"!==a.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",n),e.addEventListener("animationcancel",n)},[]),(0,a.useEffect)(()=>{let e=u.current,t=()=>{e.removeEventListener("animationend",t),i?function(e,t,n){void 0===n&&(n=300);let{scrollHeight:a,style:r}=e;requestAnimationFrame(()=>{r.minHeight="initial",r.height=a+"px",r.transition=`all ${n}ms`,requestAnimationFrame(()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(t,n)})})}(e,c,s):c()};m||(l?t():(g.current=1,e.className+=` ${h}`,e.addEventListener("animationend",t)))},[m]),a.createElement(a.Fragment,null,o)}}let l=new Map,c=[],u=new Set,m=()=>l.size>0;function p(e,t){l.forEach(n=>{null!=t&&null!=t&&t.containerId?(null==t?void 0:t.containerId)===n.id&&n.toggle(e,null==t?void 0:t.id):n.toggle(e,null==t?void 0:t.id)})}let f=1,h=()=>""+f++;function g(e,t){return o(e)&&(m()||c.push({content:e,options:t}),l.forEach(n=>{n.buildToast(e,t)})),t.toastId}function v(e,t){return{...t,type:t&&t.type||e,toastId:t&&(i(t.toastId)||r(t.toastId))?t.toastId:h()}}function y(e){return(t,n)=>g(t,v(e,n))}function x(e,t){return g(e,v("default",t))}x.loading=(e,t)=>g(e,v("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),x.promise=function(e,t,n){let a,{pending:r,error:o,success:d}=t;r&&(a=i(r)?x.loading(r,n):x.loading(r.render,{...n,...r}));let l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},c=(e,t,r)=>{if(null==t)return void x.dismiss(a);let s={type:e,...l,...n,data:r},o=i(t)?{render:t}:t;return a?x.update(a,{...s,...o}):x(o.render,{...s,...o}),r},u=s(e)?e():e;return u.then(e=>c("success",d,e)).catch(e=>c("error",o,e)),u},x.success=y("success"),x.info=y("info"),x.error=y("error"),x.warning=y("warning"),x.warn=x.warning,x.dark=(e,t)=>g(e,v("default",{theme:"dark",...t})),x.dismiss=function(e){!function(e){var t;if(m()){if(null==e||i(t=e)||r(t))l.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=l.get(e.containerId);t?t.removeToast(e.id):l.forEach(t=>{t.removeToast(e.id)})}}else c=c.filter(t=>null!=e&&t.options.toastId!==e)}(e)},x.clearWaitingQueue=function(e){void 0===e&&(e={}),l.forEach(t=>{!t.props.limit||e.containerId&&t.id!==e.containerId||t.clearQueue()})},x.isActive=function(e,t){var n;if(t)return!(null==(n=l.get(t))||!n.isToastActive(e));let a=!1;return l.forEach(t=>{t.isToastActive(e)&&(a=!0)}),a},x.update=function(e,t){void 0===t&&(t={});let n=((e,t)=>{var n;let{containerId:a}=t;return null==(n=l.get(a||1))?void 0:n.toasts.get(e)})(e,t);if(n){let{props:a,content:r}=n,i={delay:100,...a,...t,toastId:t.toastId||e,updateId:h()};i.toastId!==e&&(i.staleId=e);let s=i.render||r;delete i.render,g(s,i)}},x.done=e=>{x.update(e,{progress:1})},x.onChange=function(e){return u.add(e),()=>{u.delete(e)}},x.play=e=>p(!0,e),x.pause=e=>p(!1,e),"undefined"!=typeof window?a.useLayoutEffect:a.useEffect;let N=function(e,t){return void 0===t&&(t=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}};d(N("bounce",!0)),d(N("slide",!0)),d(N("zoom")),d(N("flip"))}},function(e){e.O(0,[290,66,888,774,179],function(){return e(e.s=8263)}),_N_E=e.O()}]);